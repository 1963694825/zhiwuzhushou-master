<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¤ç‰©åŠ©æ‰‹ API æµ‹è¯•å°</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f5f5f7; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h1 { margin-top: 0; color: #1d1d1f; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 500; color: #86868b; }
        input { width: 100%; padding: 10px; border: 1px solid #d2d2d7; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        button { background-color: #0071e3; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-size: 16px; cursor: pointer; transition: background 0.2s; }
        button:hover { background-color: #0077ed; }
        button:disabled { background-color: #a1a1a6; cursor: not-allowed; }
        #log { background: #1d1d1f; color: #39ff14; padding: 15px; border-radius: 8px; font-family: 'Menlo', 'Consolas', monospace; white-space: pre-wrap; word-break: break-all; min-height: 200px; max-height: 500px; overflow-y: auto; font-size: 13px; }
        .status-ok { color: #28cd41; font-weight: bold; }
        .status-err { color: #ff3b30; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸŒ¿ æ¤ç‰©åŠ©æ‰‹ API æµ‹è¯•å°</h1>
    
    <div class="card">
        <div class="input-group">
            <label>åç«¯æ¥å£åœ°å€ (Server URL)</label>
            <input type="text" id="serverUrl" value="http://localhost:9000/api/plants/search" placeholder="ä¾‹å¦‚ http://localhost:9000/api/plants/search">
        </div>
        <div class="input-group">
            <label>æœç´¢å…³é”®è¯ (Query)</label>
            <input type="text" id="query" value="rose" placeholder="è¾“å…¥æ¤ç‰©è‹±æ–‡åï¼Œå¦‚ bamboo">
        </div>
        <button onclick="testApi()" id="btn">ğŸš€ å‘èµ·æµ‹è¯•</button>
    </div>

    <div class="card">
        <label>è°ƒè¯•æ—¥å¿— (Response Log)</label>
        <div id="log">ç­‰å¾…æµ‹è¯•...</div>
    </div>

    <script>
        async function testApi() {
            const btn = document.getElementById('btn');
            const log = document.getElementById('log');
            const serverUrl = document.getElementById('serverUrl').value;
            const query = document.getElementById('query').value;

            btn.disabled = true;
            btn.innerText = 'â³ è¯·æ±‚ä¸­...';
            log.innerText = `[${new Date().toLocaleTimeString()}] å‡†å¤‡è¯·æ±‚: ${serverUrl}?q=${query} ...\n`;

            try {
                const startTime = Date.now();
                const res = await fetch(`${serverUrl}?q=${query}`);
                const duration = Date.now() - startTime;
                
                log.innerText += `[${new Date().toLocaleTimeString()}] çŠ¶æ€ç : ${res.status} (${res.statusText})\n`;
                log.innerText += `[INFO] è€—æ—¶: ${duration}ms\n\n`;

                const data = await res.json();
                
                if (res.ok) {
                    log.innerHTML += `<span class="status-ok">âœ… è¯·æ±‚æˆåŠŸ!</span>\n`;
                    log.innerText += `æ”¶åˆ°æ•°æ®: ${JSON.stringify(data, null, 2)}`;
                } else {
                    log.innerHTML += `<span class="status-err">âŒ è¯·æ±‚å¤±è´¥ (Server Error)</span>\n`;
                    log.innerText += `Errorè¯¦æƒ…: ${JSON.stringify(data, null, 2)}`;
                }

            } catch (err) {
                log.innerHTML += `<span class="status-err">ğŸ’” ç½‘ç»œé”™è¯¯ (Network Error)</span>\n`;
                log.innerText += `\nåŸå› åˆ†æ:\n1. åç«¯æœåŠ¡æ²¡å¯åŠ¨ï¼Ÿ\n2. è·¨åŸŸ(CORS)æ²¡é…ç½®ï¼Ÿ\n3. URLå†™é”™äº†ï¼Ÿ\n\nå®Œæ•´é”™è¯¯: ${err.message}`;
            } finally {
                btn.disabled = false;
                btn.innerText = 'ğŸš€ å‘èµ·æµ‹è¯•';
            }
        }
    </script>
</body>
</html>
