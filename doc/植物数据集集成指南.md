# æ¤ç‰©æ•°æ®é›†é›†æˆæŒ‡å—

> æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•å°†GitHubä¸Šçš„ä¼˜è´¨æ¤ç‰©æ•°æ®é›†é›†æˆåˆ°æ¤ç‰©åŠ©æ‰‹é¡¹ç›®ä¸­

---

## âœ… æ‰§è¡ŒçŠ¶æ€

**æœ€åæ›´æ–°**: 2026-02-06

| æ­¥éª¤ | çŠ¶æ€ | è¯´æ˜ |
|:---|:---:|:---|
| æ•°æ®é›†ä¸‹è½½ | âœ… å®Œæˆ | å·²ä¸‹è½½ plantlist_data (49,479æ¡) å’Œ PlantFlowerDatasets (30,993æ¡) |
| ç¯å¢ƒå‡†å¤‡ | âœ… å®Œæˆ | å·²å®‰è£… pandas, openpyxl |
| æ•°æ®è½¬æ¢ | âœ… å®Œæˆ | å·²ç”Ÿæˆ `cnplants_converted.json` (20MB) |
| è„šæœ¬åˆ›å»º | âœ… å®Œæˆ | å·²åˆ›å»º `convert_xlsx_to_json.py` å’Œ `import_china_plants.js` |
| æ•°æ®å¯¼å…¥ | â³ å¾…æ‰§è¡Œ | éœ€è¦é…ç½®æ•°æ®åº“è¿æ¥åæ‰§è¡Œ |
| éªŒè¯æµ‹è¯• | â³ å¾…æ‰§è¡Œ | å¯¼å…¥å®Œæˆåè¿›è¡ŒéªŒè¯ |

**å®é™…æ•°æ®è§„æ¨¡**:
- ğŸ“Š æ€»è®°å½•æ•°: **49,479** æ¡æ¤ç‰©æ•°æ®
- ğŸ’¾ JSONæ–‡ä»¶å¤§å°: **20.0 MB**
- ğŸŒ¿ æ•°æ®å­—æ®µ: 12ä¸ª (ä¸­æ–‡åã€å­¦åã€ç§‘å±ã€åˆ†å¸ƒã€æµ·æ‹”ã€æ¿’å±ç­‰çº§ç­‰)

---

## ğŸ“š æ¨èæ•°æ®é›†

### 1. lovebull/PlantFlowerDatasets (æ¤ç‰©èŠ±å‰æ•°æ®é›†)
- **GitHubåœ°å€**: https://github.com/lovebull/PlantFlowerDatasets
- **æ•°æ®æ¥æº**: åŸºäºã€Šä¸­å›½æ¤ç‰©å¿—ã€‹(Flora of China)
- **æ•°æ®è§„æ¨¡**: 30,142ä¸ªæ¤ç‰©ç‰©ç§
- **æ•°æ®å†…å®¹**: 
  - æ¤ç‰©å­¦å(Scientific Name)
  - ä¸­æ–‡åç§°
  - å½¢æ€ç‰¹å¾æè¿°
  - ç”Ÿæ€ç¯å¢ƒä¿¡æ¯
  - åœ°ç†åˆ†å¸ƒæ•°æ®
- **ä¼˜åŠ¿**: ä¸­æ–‡æ•°æ®å®Œæ•´,é€‚åˆå›½å†…æ¤ç‰©ç§‘æ™®åº”ç”¨

### 2. ä¸­å›½æ¤ç‰©åå½•æ•°æ®åº“
- **GitHubåœ°å€**: https://github.com/topics/chinese-plants
- **æ•°æ®æ ¼å¼**: ç»“æ„åŒ–JSON/CSV
- **æ•°æ®æ¥æº**: æ•´åˆã€Šä¸­å›½æ¤ç‰©å¿—ã€‹ç­‰æƒå¨èµ„æ–™
- **ä¼˜åŠ¿**: æ•°æ®ç»“æ„åŒ–ç¨‹åº¦é«˜,æ˜“äºå¯¼å…¥æ•°æ®åº“

---

## ğŸš€ é›†æˆæ­¥éª¤

### ç¬¬ä¸€æ­¥: ä¸‹è½½æ•°æ®é›†

#### æ–¹æ¡ˆA: ä½¿ç”¨Gitå…‹éš† (æ¨è)
```bash
# è¿›å…¥é¡¹ç›®dataç›®å½•
cd g:\work\zhiwuzhushou-master\data

# å…‹éš†PlantFlowerDatasetsä»“åº“
git clone https://github.com/lovebull/PlantFlowerDatasets.git

# æˆ–è€…ä½¿ç”¨æµ…å…‹éš†èŠ‚çœç©ºé—´
git clone --depth=1 https://github.com/lovebull/PlantFlowerDatasets.git
```

#### æ–¹æ¡ˆB: æ‰‹åŠ¨ä¸‹è½½
1. è®¿é—® https://github.com/lovebull/PlantFlowerDatasets
2. ç‚¹å‡» `Code` -> `Download ZIP`
3. è§£å‹åˆ° `g:\work\zhiwuzhushou-master\data\` ç›®å½•

---

### ç¬¬äºŒæ­¥: æ•°æ®ç»“æ„åˆ†æ

ä¸‹è½½å,æŸ¥çœ‹æ•°æ®é›†çš„æ–‡ä»¶ç»“æ„:
```
data/
â””â”€â”€ PlantFlowerDatasets/
    â”œâ”€â”€ README.md           # æ•°æ®é›†è¯´æ˜
    â”œâ”€â”€ plants.json         # ä¸»æ•°æ®æ–‡ä»¶(å‡è®¾)
    â”œâ”€â”€ images/             # æ¤ç‰©å›¾ç‰‡(å¦‚æœ‰)
    â””â”€â”€ metadata.json       # å…ƒæ•°æ®ä¿¡æ¯
```

**å…³é”®å­—æ®µæ˜ å°„** (éœ€æ ¹æ®å®é™…æ•°æ®è°ƒæ•´):
| æ•°æ®é›†å­—æ®µ | æ•°æ®åº“å­—æ®µ | è¯´æ˜ |
|:---|:---|:---|
| `name` / `chinese_name` | `chinese_name` | ä¸­æ–‡åç§° |
| `scientific_name` / `latin_name` | `scientific_name` | å­¦å |
| `family` | `family` | ç§‘ |
| `genus` | `genus` | å± |
| `description` / `morphology` | `description` | å½¢æ€æè¿° |
| `distribution` | è‡ªå®šä¹‰å­—æ®µ | åœ°ç†åˆ†å¸ƒ |
| `ecology` | è‡ªå®šä¹‰å­—æ®µ | ç”Ÿæ€ç¯å¢ƒ |

---

### ç¬¬ä¸‰æ­¥: æ‰©å±•æ•°æ®åº“è¡¨ç»“æ„

æ ¹æ®æ–°æ•°æ®é›†çš„å­—æ®µ,æ‰©å±•ç°æœ‰çš„ `plants` è¡¨:

```sql
-- åœ¨ plant_assistant æ•°æ®åº“ä¸­æ‰§è¡Œ
USE plant_assistant;

-- æ·»åŠ æ–°å­—æ®µä»¥æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®
ALTER TABLE plants 
ADD COLUMN `distribution` TEXT COMMENT 'åœ°ç†åˆ†å¸ƒ' AFTER description,
ADD COLUMN `ecology` TEXT COMMENT 'ç”Ÿæ€ç¯å¢ƒ' AFTER distribution,
ADD COLUMN `use_value` TEXT COMMENT 'åº”ç”¨ä»·å€¼' AFTER ecology,
ADD COLUMN `conservation_status` VARCHAR(50) COMMENT 'ä¿æŠ¤ç­‰çº§' AFTER use_value,
ADD COLUMN `data_source` VARCHAR(100) DEFAULT 'PlantFlowerDatasets' COMMENT 'æ•°æ®æ¥æº' AFTER conservation_status;

-- æ·»åŠ ç´¢å¼•ä»¥æå‡æŸ¥è¯¢æ€§èƒ½
CREATE INDEX idx_family ON plants(family);
CREATE INDEX idx_genus ON plants(genus);
CREATE FULLTEXT INDEX idx_description ON plants(description, distribution, ecology);
```

---

### ç¬¬å››æ­¥: ç¼–å†™æ•°æ®å¯¼å…¥è„šæœ¬

åˆ›å»ºæ–°çš„å¯¼å…¥è„šæœ¬ `scripts/import_github_plants.js`:

```javascript
// å¯¼å…¥GitHubæ¤ç‰©æ•°æ®é›†åˆ° MySQL
const mysql = require('mysql2/promise');
const fs = require('fs');
const path = require('path');

async function importGitHubPlants() {
    try {
        // 1. è¯»å–æ•°æ®
        const dataPath = path.join(__dirname, '../data/PlantFlowerDatasets/plants.json');
        
        if (!fs.existsSync(dataPath)) {
            console.error('âŒ æ•°æ®æ–‡ä»¶ä¸å­˜åœ¨,è¯·å…ˆä¸‹è½½æ•°æ®é›†!');
            console.log('ğŸ“¥ ä¸‹è½½åœ°å€: https://github.com/lovebull/PlantFlowerDatasets');
            process.exit(1);
        }

        const plantsData = JSON.parse(fs.readFileSync(dataPath, 'utf-8'));
        console.log(`ğŸ“Š è¯»å–åˆ° ${plantsData.length} æ¡æ¤ç‰©æ•°æ®\n`);

        // 2. è¿æ¥æ•°æ®åº“
        const connection = await mysql.createConnection({
            host: 'localhost',
            user: 'root',
            password: 'root',  // è¯·ä¿®æ”¹ä¸ºå®é™…å¯†ç 
            database: 'plant_assistant',
            charset: 'utf8mb4'
        });

        console.log('âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ\n');

        // 3. å¼€å§‹å¯¼å…¥
        console.log('ğŸ“¥ å¼€å§‹å¯¼å…¥æ•°æ®...\n');
        let successCount = 0;
        let skipCount = 0;

        for (const plant of plantsData) {
            try {
                // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨(æ ¹æ®å­¦åå»é‡)
                const [existing] = await connection.execute(
                    'SELECT id FROM plants WHERE scientific_name = ?',
                    [plant.scientific_name || plant.latin_name]
                );

                if (existing.length > 0) {
                    skipCount++;
                    console.log(`â­ï¸  [è·³è¿‡] ${plant.chinese_name || plant.name} (å·²å­˜åœ¨)`);
                    continue;
                }

                // æ’å…¥æ–°æ•°æ®
                await connection.execute(`
                    INSERT INTO plants (
                        chinese_name, scientific_name, english_name,
                        family, genus, description, 
                        distribution, ecology, use_value,
                        flowering_period, image_url, data_source
                    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                `, [
                    plant.chinese_name || plant.name || '',
                    plant.scientific_name || plant.latin_name || '',
                    plant.english_name || '',
                    plant.family || '',
                    plant.genus || '',
                    plant.description || plant.morphology || '',
                    plant.distribution || '',
                    plant.ecology || '',
                    plant.use_value || plant.usage || '',
                    plant.flowering_period || '',
                    plant.image_url || plant.image || '',
                    'PlantFlowerDatasets'
                ]);

                successCount++;
                console.log(`âœ… [${successCount}] ${plant.chinese_name || plant.name}`);

            } catch (err) {
                console.error(`âŒ å¯¼å…¥å¤±è´¥: ${plant.chinese_name}`, err.message);
            }
        }

        console.log('\n' + '='.repeat(60));
        console.log(`âœ… æˆåŠŸå¯¼å…¥: ${successCount} æ¡`);
        console.log(`â­ï¸  è·³è¿‡é‡å¤: ${skipCount} æ¡`);
        console.log(`ğŸ“Š æ€»è®¡å¤„ç†: ${plantsData.length} æ¡`);
        console.log('='.repeat(60));

        await connection.end();

    } catch (error) {
        console.error('âŒ å¯¼å…¥å¤±è´¥:', error.message);
        process.exit(1);
    }
}

importGitHubPlants();
```

---

### ç¬¬äº”æ­¥: æ‰§è¡Œæ•°æ®å¯¼å…¥

```bash
# 1. ç¡®ä¿å·²å®‰è£…ä¾èµ–
cd g:\work\zhiwuzhushou-master
npm install mysql2

# 2. æ‰§è¡Œå¯¼å…¥è„šæœ¬
node scripts/import_github_plants.js
```

**é¢„æœŸè¾“å‡º**:
```
ğŸ“Š è¯»å–åˆ° 30142 æ¡æ¤ç‰©æ•°æ®

âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ

ğŸ“¥ å¼€å§‹å¯¼å…¥æ•°æ®...

âœ… [1] é“¶æ
âœ… [2] æ°´æ‰
âœ… [3] ç™æ¡
...
============================================================
âœ… æˆåŠŸå¯¼å…¥: 30142 æ¡
â­ï¸  è·³è¿‡é‡å¤: 0 æ¡
ğŸ“Š æ€»è®¡å¤„ç†: 30142 æ¡
============================================================
```

---

### ç¬¬å…­æ­¥: æ•°æ®éªŒè¯

```sql
-- æŸ¥è¯¢å¯¼å…¥çš„æ•°æ®ç»Ÿè®¡
SELECT 
    COUNT(*) as total_plants,
    COUNT(DISTINCT family) as total_families,
    COUNT(DISTINCT genus) as total_genus,
    data_source
FROM plants 
WHERE data_source = 'PlantFlowerDatasets'
GROUP BY data_source;

-- æŸ¥çœ‹ç¤ºä¾‹æ•°æ®
SELECT 
    chinese_name, 
    scientific_name, 
    family, 
    genus,
    LEFT(description, 50) as description_preview
FROM plants 
WHERE data_source = 'PlantFlowerDatasets'
LIMIT 10;
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: æ•°æ®æ–‡ä»¶æ ¼å¼ä¸åŒ¹é…æ€ä¹ˆåŠ?
**A**: ä¸‹è½½æ•°æ®é›†å,å…ˆæŸ¥çœ‹å®é™…çš„JSONç»“æ„,ç„¶åä¿®æ”¹ `import_github_plants.js` ä¸­çš„å­—æ®µæ˜ å°„å…³ç³»ã€‚

### Q2: å¯¼å…¥æ—¶å‡ºç°å­—ç¬¦ç¼–ç é”™è¯¯?
**A**: ç¡®ä¿:
- æ•°æ®åº“ä½¿ç”¨ `utf8mb4` å­—ç¬¦é›†
- JSONæ–‡ä»¶ä¿å­˜ä¸º UTF-8 ç¼–ç 
- Node.jsè¯»å–æ–‡ä»¶æ—¶æŒ‡å®š `'utf-8'` ç¼–ç 

### Q3: å¦‚ä½•å¤„ç†å›¾ç‰‡æ•°æ®?
**A**: 
1. å¦‚æœæ•°æ®é›†åŒ…å«å›¾ç‰‡URL,ç›´æ¥å­˜å‚¨åˆ° `image_url` å­—æ®µ
2. å¦‚æœæ˜¯æœ¬åœ°å›¾ç‰‡,éœ€è¦:
   - å°†å›¾ç‰‡ä¸Šä¼ åˆ°æœåŠ¡å™¨ `static/images/plants/` ç›®å½•
   - æˆ–ä¸Šä¼ åˆ°äº‘å­˜å‚¨(å¦‚é˜¿é‡Œäº‘OSSã€è…¾è®¯äº‘COS)
   - æ›´æ–° `image_url` ä¸ºå¯è®¿é—®çš„URL

### Q4: æ•°æ®é‡å¤ªå¤§,å¯¼å…¥å¾ˆæ…¢?
**A**: ä¼˜åŒ–æ–¹æ¡ˆ:
```javascript
// ä½¿ç”¨æ‰¹é‡æ’å…¥
const batchSize = 100;
for (let i = 0; i < plantsData.length; i += batchSize) {
    const batch = plantsData.slice(i, i + batchSize);
    const values = batch.map(p => [
        p.chinese_name, p.scientific_name, /* ... */
    ]);
    
    await connection.query(
        'INSERT INTO plants (...) VALUES ?',
        [values]
    );
}
```

---

## ğŸ“Š æ•°æ®é›†å¯¹æ¯”

| ç‰¹æ€§ | PlantFlowerDatasets | ä¸­å›½æ¤ç‰©åå½• | å½“å‰é¡¹ç›®æ•°æ® |
|:---|:---:|:---:|:---:|
| æ•°æ®é‡ | 30,142 | ~35,000 | å°‘é‡ |
| ä¸­æ–‡æ”¯æŒ | âœ… å®Œæ•´ | âœ… å®Œæ•´ | âœ… |
| å½¢æ€æè¿° | âœ… è¯¦ç»† | âš ï¸ ç®€ç•¥ | âœ… |
| åœ°ç†åˆ†å¸ƒ | âœ… | âœ… | âŒ |
| å›¾ç‰‡èµ„æº | âš ï¸ éƒ¨åˆ† | âŒ | âœ… |
| æ›´æ–°é¢‘ç‡ | ä¸­ç­‰ | ä½ | æ‰‹åŠ¨ |

---

## ğŸ¯ åç»­ä¼˜åŒ–å»ºè®®

1. **æ•°æ®æ¸…æ´—**: å»é™¤é‡å¤æ•°æ®,ç»Ÿä¸€å­—æ®µæ ¼å¼
2. **å›¾ç‰‡è¡¥å……**: å¯¹äºç¼ºå°‘å›¾ç‰‡çš„æ¤ç‰©,å¯ä»¥:
   - ä½¿ç”¨çˆ¬è™«ä»ç™¾åº¦ç™¾ç§‘ç­‰ç½‘ç«™è·å–
   - æ¥å…¥ç¬¬ä¸‰æ–¹æ¤ç‰©å›¾ç‰‡API
   - ä½¿ç”¨AIç”Ÿæˆæ¤ç‰©å›¾ç‰‡
3. **æ•°æ®å¢å¼º**: æ·»åŠ :
   - æ¤ç‰©åˆ«å
   - è¯ç”¨ä»·å€¼
   - æ ½åŸ¹è¦ç‚¹
   - ç›¸å…³æ¤ç‰©æ¨è
4. **æœç´¢ä¼˜åŒ–**: å»ºç«‹å…¨æ–‡ç´¢å¼•,æ”¯æŒæ¨¡ç³Šæœç´¢
5. **å®šæœŸæ›´æ–°**: è®¾ç½®å®šæ—¶ä»»åŠ¡,åŒæ­¥æ•°æ®é›†æ›´æ–°

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“è®¾è®¡æ–¹æ¡ˆ](../database_design.md)
- [å¼€å‘æµç¨‹æ–‡æ¡£](../development_process.md)
- [åŸæœ‰å¯¼å…¥è„šæœ¬](../scripts/import_plants.js)

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜,å¯ä»¥:
1. æŸ¥çœ‹æ•°æ®é›†çš„GitHub Issues
2. æ£€æŸ¥é¡¹ç›®çš„ `server/logs/` æ—¥å¿—æ–‡ä»¶
3. åœ¨é¡¹ç›®ä¸­æäº¤Issue

---

**æœ€åæ›´æ–°**: 2026-02-06
**ç»´æŠ¤è€…**: æ¤ç‰©åŠ©æ‰‹å¼€å‘å›¢é˜Ÿ
