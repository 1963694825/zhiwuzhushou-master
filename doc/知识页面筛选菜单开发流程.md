# 知识页面筛选菜单开发流程文档 (终极优化版 V3 - 强化关联版)

## 一、 数据库初始化 (多对多关联版)

采用映射表设计，品种可以关联多个大类，文章也可以关联多个品种。

```sql
-- 1. 一级大类表 (顶部菜单: 水果, 蔬菜)
CREATE TABLE IF NOT EXISTS `knowledge_primary_categories` (
    `id` INT AUTO_INCREMENT PRIMARY KEY,
    `name` VARCHAR(50) NOT NULL,
    `sort_order` INT DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 2. 二级细分表 (如: 灌木类水果, 果树类水果)
CREATE TABLE IF NOT EXISTS `knowledge_secondary_categories` (
    `id` INT AUTO_INCREMENT PRIMARY KEY,
    `primary_id` INT NOT NULL,
    `name` VARCHAR(50) NOT NULL,
    `sort_order` INT DEFAULT 0,
    FOREIGN KEY (`primary_id`) REFERENCES `knowledge_primary_categories`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 3. 品种基础信息表
CREATE TABLE IF NOT EXISTS `knowledge_species` (
    `id` INT AUTO_INCREMENT PRIMARY KEY,
    `name` VARCHAR(50) NOT NULL,
    `sort_order` INT DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 4. 【核心关联】品种-分类映射表
CREATE TABLE IF NOT EXISTS `knowledge_species_category_mapping` (
    `species_id` INT NOT NULL,
    `primary_id` INT NOT NULL,
    `secondary_id` INT NOT NULL,
    PRIMARY KEY (`species_id`, `primary_id`, `secondary_id`),
    FOREIGN KEY (`species_id`) REFERENCES `knowledge_species`(`id`) ON DELETE CASCADE,
    FOREIGN KEY (`primary_id`) REFERENCES `knowledge_primary_categories`(`id`) ON DELETE CASCADE,
    FOREIGN KEY (`secondary_id`) REFERENCES `knowledge_secondary_categories`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 5. 知识文章表
CREATE TABLE IF NOT EXISTS `knowledge_articles` (
    `id` INT AUTO_INCREMENT PRIMARY KEY,
    `title` VARCHAR(255) NOT NULL,
    `summary` VARCHAR(500),
    `content` LONGTEXT,
    `knowledge_type` VARCHAR(50),
    `publish_time` DATETIME DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 6. 【核心关联】文章-品种映射表
CREATE TABLE IF NOT EXISTS `knowledge_article_species_mapping` (
    `article_id` INT NOT NULL,
    `species_id` INT NOT NULL,
    PRIMARY KEY (`article_id`, `species_id`),
    FOREIGN KEY (`article_id`) REFERENCES `knowledge_articles`(`id`) ON DELETE CASCADE,
    FOREIGN KEY (`species_id`) REFERENCES `knowledge_species`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```
---
## 二、 交互逻辑

1.  **顶部选择**: 用户选择“大类+子类”时，通过 `mapping` 表查询在该范围内的所有 `species_id`。
2.  **左侧加载**: 展示这些品种名。
3.  **结果筛选**: 点击侧边栏品种，通过 `article_species_mapping` 找到对应文章。
